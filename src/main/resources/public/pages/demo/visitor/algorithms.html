<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

</head>

<body>
    <div id="algorithms" class="text-center container">
        <div class="ml-auto mr-auto" style="display: inline-block">
            <span class="h4 text-center ml-auto mr-auto">{{title}}</span>
            <hr>
            <span>{{secondtitle}}</span>

        </div>
        <div id="guideinfo" class="border border-darken-1">
            <div class="mt-2">
                <h4 class="text-center" >{{guideinfotitile}}</h5>
            </div>
            <div class="text-left ml-2 mr-2" style="font-size: 16px;" v-html="guideinfocontent">

            </div>
        </div>
        <br />
        <br />
        <!--下拉条-->
        <div class="accordion" id="accordionExample">
            <div v-for="(algorithm,algorithmIndex) in algorithms" v-bind:key="algorithmIndex">
                <!--下拉条1即算法1-->
                <div class="card">
                    <div class="card-header" :id="'algorithmcard'+algorithmIndex">
                        <div class="row">
                            <div class="col-2 m-auto">
                                <!--算法信息modal按钮-->
                                <span class="text-dark">
                                    <button type="button" class="btn btn-link m-0"
                                        v-on:click="getalgorithmdetails(algorithmIndex)">{{algorithm.algorithmName}}
                                    </button>
                                </span>
                            </div>
                            <!--下拉图标-->
                            <div class="col-10 ">
                                <button class="btn btn-link float-right" type="button" data-toggle="collapse"
                                    :data-target="'#algorithmcollapseOne'+algorithmIndex" aria-expanded="true"
                                    aria-controls="collapseOne" style="display:inline">
                                    <svg class="bi bi-chevron-bar-down float-right" width="2em" height="2em"
                                        viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd"
                                            d="M3.646 4.146a.5.5 0 01.708 0L8 7.793l3.646-3.647a.5.5 0 01.708.708l-4 4a.5.5 0 01-.708 0l-4-4a.5.5 0 010-.708zM1 11.5a.5.5 0 01.5-.5h13a.5.5 0 010 1h-13a.5.5 0 01-.5-.5z"
                                            clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!--下拉内容-->
                    <div :id="'algorithmcollapseOne'+algorithmIndex" class="collapse show" aria-labelledby="headingOne"
                        data-parent="#accordionExample">
                        <div class="card-body">
                            <span class="h4 text-center ml-auto mr-auto">{{givittry}}</span>
                            <br>
                            <p>{{algorithm.algorithmDescription}}</p>
                            <hr width="30%" />
                            <div class="row border border-darken-1 m-2">
                                <!--左边框-->
                                <div class="col-6  border border-darken-1 bg-light">
                                    <div class="input-group mb-3 mt-3 ml-2">
                                        <form class="was-validated" style="width: 80%">
                                            <div class="form-group">
                                                <select class="custom-select is-invalid" required
                                                                 v-model="algorithm.parameterSchemeIndex">
                                                <option select="selected" disabled value="-1">choose</option>
                                                <option
                                                        v-for="(parameterScheme,parameterSchemeIndex) in algorithm.parameterSchemes"
                                                        v-bind:value="parameterSchemeIndex">
                                                    {{parameterScheme.schemeName}}</option>
                                            </select>
                                            </div>
                                        </form>
                                        <span class="input-group-btn ml-3">
                                            <button class="btn btn-primary" type="button"
                                                v-on:click="submitParameterToExecute(algorithmIndex,algorithm.parameterSchemeIndex)">{{run}}</button>
                                        </span>
                                    </div>
                                    <div class="alert alert-info" role="alert">
                                        {{schemehead}}
                                    </div>
                                    <!--参数介绍-->
                                    <div class="row pre-scrollable m-2">
                                        <ul class="list-group" style="width:100%">
                                            <li class="list-group-item" style="width:100%"
                                                v-for="(parameterScheme,parameterSchemeIndex) in algorithm.parameterSchemes"
                                                v-bind:key="parameterSchemeIndex">
                                                <button type="button" data-toggle="modal" data-target="#parameterInfo"
                                                    class="btn btn-link m-0"
                                                    v-on:click="getParameterInfo(algorithmIndex,parameterSchemeIndex)">{{parameterScheme.schemeName}}</button>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-6  border border-darken-1">
                                    <div class="row bg-light" style="height:100%">
                                        <!--运行结果展示-->
                                        <div :id="'resultInfo'+algorithmIndex" class=" m-auto" style="width:90%;height:80%;display: flex;
                                            justify-content: center;
                                            align-items: center;">
                                            <div class="m-auto text-center"><svg class="bi bi-graph-up" width="7em"
                                                    height="7em" viewBox="0 0 16 16" fill="currentColor"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M0 0h1v16H0V0zm1 15h15v1H1v-1z" />
                                                    <path fill-rule="evenodd"
                                                        d="M14.39 4.312L10.041 9.75 7 6.707l-3.646 3.647-.708-.708L7 5.293 9.959 8.25l3.65-4.563.781.624z"
                                                        clip-rule="evenodd" />
                                                    <path fill-rule="evenodd"
                                                        d="M10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4h-3.5a.5.5 0 0 1-.5-.5z"
                                                        clip-rule="evenodd" />
                                                </svg>
                                                <p class="resulttext mt-3">{{resulttext}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div id="schemesdetailspop"></div>
    <script type="text/javascript">
        var vue_demo_algorithms = new Vue({
            el: '#algorithms',
            data: {
                //-----------pageElement------------
                title: '',
                secondtitle: '',
                guideinfotitile:'',
                guideinfocontent:'',
                givittry: '',
                run: '',
                schemehead: '',
                resulttext: '',

                //-----------algorithmData------------
                selected: '',
                algorithms: []
            },
            methods: {
                submitParameterToExecute(algorithmIndex, parameterSchemeIndex) {
                    $('#resulterror').hide();
                    var toPostAlgorithmid = this.algorithms[algorithmIndex].algorithmId;
                    var toPostParameterId = this.algorithms[algorithmIndex].parameterSchemes[parameterSchemeIndex].schemeId;
                    console.log(toPostParameterId);
                    var resultcontainerIndex = "resultInfo" + algorithmIndex;
                    echarts.init(document.getElementById(resultcontainerIndex)).dispose();
                        var myChart = echarts.init(document.getElementById(resultcontainerIndex));
                    myChart.setOption({
                        title: [{
                            text: 'Reduct',
                            left: 'center'
                        },
                        {
                            text: 'rudcts is',
                            left: '30%',
                            bottom: '10%'
                        }],
                        series: [{
                            radius: '50%',
                            center: ['17%', '50%'],
                            name: '结果',
                            type: 'pie',
                            data: [3, 7]
                        }]
                    });
                    myChart.showLoading()
                    $.post(demoVisitorBaseURL+"/transmitExcuteInfo", { "algorithmId": toPostAlgorithmid,
                        "parameterSchemeId": toPostParameterId }, function (data) {
                        console.log(data)
                        if (data.code==200){
                        myChart.setOption({
                            title: [{
                                text: 'Reduct',
                                left: 'center'
                            },
                            {
                                text: 'rudcts is {' + data.reducts + '}',
                                left: 'center',
                                bottom: '10%'

                            }],
                        });
                            myChart.hideLoading();
                        }else if(data.code==400){
                            myChart.hideLoading();
                            echarts.init(document.getElementById(resultcontainerIndex)).dispose();
                            alert("please do it again")
                        }

                    });
                },
            },
            created: function () {
                axios.get(demoVisitorBaseURL + "/getPageelementByHtmlName?htmlname=algorithms").then((response) => {
                    for (let i = 0; i < response.data.length; i++) {
                        for (item in this._data) {
                            if (response.data[i].moduleKey == item) {
                                if ($.cookie("language") == 'ch') {
                                    this.$set(this._data, item, response.data[i].chValue);
                                } else {
                                    this.$set(this._data, item, response.data[i].enValue);
                                }
                            }
                        }
                    }
                });
            },
            watch: {
                getName: {
                    handler: function () {
                        //do something
                    },
                }
            }
        });

        $(function () {
            $('#schemesdetailspop').load('popups/demo/visitor/schemesDetails.html')
            $.get(demoVisitorBaseURL+"/getAllAlgorithmInfo", function (data) {
                vue_demo_algorithms.algorithms = data;
            });
            $('#algorithmdetailspop').load('popups/demo/visitor/algorithmDetails.html');
            $('#algorithmdetailspop').hide();

        });

        //给select添加默认option
        function addOption() {
            var option="<option selected=\"true\" disabled=\"true\" value=\"\">Choose...</option>"
            $("select").prepend(option)
        }

        //获取参数详情
        function getParameterInfo(algorithmIndex, parameterSchemeIndex) {
            vue_parameterInfo.parameterScheme = vue_demo_algorithms.algorithms[algorithmIndex].parameterSchemes[parameterSchemeIndex];
        }

        //获取算法详情
        function getalgorithmdetails(algorithmIndex) {
            $("#demo-guide").empty();
            $("#demo-algorithms").empty();
            $("#demo-updates").empty();
            vue_demo_algorithm_details.algorithm = vue_demo_algorithms.algorithms[algorithmIndex];
            $('#algorithmdetailspop').show();
        }
    </script>
</body>

</html>